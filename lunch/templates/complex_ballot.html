{% extends "vogt.html" %}
{% block ballot %}
	<script type="text/javascript">
		function update(list, o)
		{
			if (!o.hasOwnProperty('old'))
			{
				o.old = o.defaultValue;
			}

			var delta = Number(o.value) - Number(o.old);

			for (var i=0; i < list.length; i++)
			{
				var newValue = Math.min(Math.max(Number(document.getElementById(list[i]).value) + delta, 0), 100);
				document.getElementById(list[i]).value = newValue;
				relabel(list[i], newValue);
			}

			o.old = o.value;
		}

		function relabel(name, value)
		{
			document.getElementById(name.concat("//display")).innerHTML = value;
		}
	</script>

	{% for category in options %}
		<tr>
			<td style="padding-top: 20px;"><i>{{ category }}</i></td>
			{% if winner %}
				<td style="text-align: right; padding-top: 20px;"><input type="range" disabled/></td>
			{% else %}
				<td style="text-align: right; padding-top: 20px;"><input type="range" value="50" onchange='update(new Array("{{ '", "'.join(options[category]) }}"), this)'/></td>
			{% endif %}
		</tr>

		{% for name in options[category] %}
			<tr>
				<td style="padding-left: 10px;">{{ form.__getattribute__(name).label }}</td>
				{% if winner %}
					<td style="text-align: right;">{{ form.__getattribute__(name)(disabled=True) }}</td>
				{% else %}
					<td style="text-align: right;">{{ form.__getattribute__(name)(onchange='relabel("{}", this.value)'.format(name)) }}</td>
				{% endif %}
				<td style="width: 30px; text-align: right;"><label id="{{ name }}//display">{{ form.__getattribute__(name).data }}</label></td>
			</tr>
		{% endfor %}
	{% endfor %}
{% endblock %}
